<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Para AlpineSki - ì¢…í•© ë¶„ì„ ëŒ€ì‹œë³´ë“œ</title>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
</head>
<body>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f5f5f5; }
.header { background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%); color: white; padding: 20px 30px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); position: sticky; top: 0; z-index: 1000; }
.header-content { display: flex; align-items: center; justify-content: space-between; }
.header-left { display: flex; align-items: center; gap: 15px; }
.icon { font-size: 40px; }
.header-text h1 { font-size: 28px; font-weight: 600; margin-bottom: 5px; }
.header-text p { font-size: 14px; opacity: 0.95; }
.tab-navigation { display: flex; gap: 10px; }
.tab-btn { background: rgba(255,255,255,0.2); color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-weight: 600; transition: all 0.2s; }
.tab-btn:hover { background: rgba(255,255,255,0.3); }
.tab-btn.active { background: white; color: #e74c3c; }
.upload-section { display: flex; justify-content: center; align-items: center; min-height: 70vh; padding: 20px; }
.upload-card { background: white; border-radius: 16px; padding: 60px 40px; text-align: center; box-shadow: 0 4px 20px rgba(0,0,0,0.1); max-width: 700px; width: 100%; }
.upload-icon { font-size: 80px; margin-bottom: 20px; }
.upload-card h2 { color: #212529; margin-bottom: 10px; font-size: 24px; }
.upload-card p { color: #6c757d; margin-bottom: 30px; }
.upload-btn { background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%); color: white; border: none; padding: 15px 40px; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; transition: transform 0.2s; }
.upload-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(231, 76, 60, 0.3); }
.file-list { margin-top: 20px; text-align: left; font-size: 14px; color: #495057; }
.file-item { padding: 8px; background: #f8f9fa; border-radius: 4px; margin-bottom: 5px; }
.file-item.loaded { background: #d4edda; color: #155724; }
.container { display: grid; grid-template-columns: 2fr 1fr; gap: 20px; padding: 20px; max-width: 1800px; margin: 0 auto; }
.left-panel, .right-panel { display: flex; flex-direction: column; gap: 20px; }
.card { background: white; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); overflow: hidden; }
.card-header { padding: 15px 20px; background: #f8f9fa; border-bottom: 1px solid #e9ecef; font-weight: 600; color: #495057; font-size: 14px; }
#map, #map2 { height: 400px; width: 100%; }
.chart-container { height: 250px; padding: 10px; }
.stats-grid { display: grid; grid-template-columns: 1fr; gap: 15px; padding: 20px; }
.stat-item { text-align: center; }
.stat-value { font-size: 36px; font-weight: 700; color: #212529; margin-bottom: 5px; }
.stat-unit { font-size: 14px; color: #e74c3c; font-weight: 600; }
.info-card { padding: 15px 20px; border-bottom: 1px solid #f0f0f0; }
.info-card:last-child { border-bottom: none; }
.info-label { font-size: 11px; color: #6c757d; margin-bottom: 5px; }
.info-value { font-size: 16px; color: #212529; font-weight: 600; }
.playback-controls { background: white; border-radius: 12px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
.control-buttons { display: flex; gap: 10px; align-items: center; margin-bottom: 15px; flex-wrap: wrap; }
.control-btn { background: #e74c3c; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-weight: 600; transition: all 0.2s; font-size: 14px; }
.control-btn:hover { background: #c0392b; }
.control-btn:disabled { background: #ccc; cursor: not-allowed; }
.progress-bar { width: 100%; height: 8px; background: #e9ecef; border-radius: 4px; overflow: hidden; cursor: pointer; }
.progress-fill { height: 100%; background: linear-gradient(90deg, #e74c3c, #f39c12); width: 0%; transition: width 0.1s linear; }
.time-display { text-align: center; margin-top: 10px; font-weight: 600; color: #495057; }
.section-info { background: #fff9e6; border-left: 4px solid #f39c12; padding: 15px; border-radius: 8px; margin-bottom: 15px; }
.section-info h3 { color: #f39c12; font-size: 14px; margin-bottom: 10px; }
.section-stats { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
.section-stat-label { color: #6c757d; margin-bottom: 3px; font-size: 12px; }
.section-stat-value { font-weight: 700; color: #212529; font-size: 16px; }
.range-selector, .event-markers { background: white; border-radius: 12px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
.range-selector h3, .event-markers h3 { font-size: 14px; color: #495057; margin-bottom: 15px; }
.range-inputs { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px; }
.range-input { display: flex; flex-direction: column; }
.range-input label { font-size: 12px; color: #6c757d; margin-bottom: 5px; }
.range-input input, .range-input select { padding: 8px; border: 1px solid #dee2e6; border-radius: 6px; font-size: 14px; }
.analyze-btn { width: 100%; background: #f39c12; color: white; border: none; padding: 12px; border-radius: 6px; font-weight: 600; cursor: pointer; transition: all 0.2s; }
.analyze-btn:hover { background: #e67e22; }
.event-list { max-height: 200px; overflow-y: auto; }
.event-item { display: flex; justify-content: space-between; align-items: center; padding: 8px 12px; background: #f8f9fa; border-radius: 6px; margin-bottom: 8px; cursor: pointer; transition: all 0.2s; }
.event-item:hover { background: #e9ecef; }
.event-time { font-weight: 600; color: #212529; font-size: 13px; }
.event-delete { color: #e74c3c; cursor: pointer; font-size: 18px; }
.add-event-btn { width: 100%; background: #3498db; color: white; border: none; padding: 10px; border-radius: 6px; font-weight: 600; cursor: pointer; margin-bottom: 15px; transition: all 0.2s; }
.add-event-btn:hover { background: #2980b9; }
.event-select { padding: 8px; border: 1px solid #dee2e6; border-radius: 6px; font-size: 12px; }
.page { display: none; }
.page.active { display: block; }
.turn-detection { background: white; border-radius: 12px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
.turn-detection h3 { font-size: 16px; color: #495057; margin-bottom: 15px; }
.detection-controls { display: flex; flex-direction: column; gap: 10px; margin-bottom: 15px; }
.detect-btn { background: #9b59b6; color: white; border: none; padding: 12px; border-radius: 6px; font-weight: 600; cursor: pointer; transition: all 0.2s; }
.detect-btn:hover { background: #8e44ad; }
.turn-list { max-height: 400px; overflow-y: auto; }
.turn-item { padding: 12px; background: #f8f9fa; border-left: 4px solid #3498db; border-radius: 6px; margin-bottom: 10px; cursor: pointer; transition: all 0.2s; }
.turn-item:hover { background: #e9ecef; }
.turn-item.right { border-left-color: #e74c3c; }
.turn-item.selected { background: #fff3cd; border-left-width: 6px; }
.turn-header { font-weight: 700; color: #212529; margin-bottom: 8px; font-size: 14px; }
.turn-details { font-size: 12px; color: #6c757d; display: grid; grid-template-columns: 1fr 1fr; gap: 5px; }
.saved-sections { background: white; border-radius: 12px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); margin-bottom: 20px; }
.saved-sections h3 { font-size: 14px; color: #495057; margin-bottom: 10px; }
.section-list { display: flex; flex-wrap: wrap; gap: 8px; }
.section-chip { padding: 8px 12px; background: #e7f3ff; color: #0066cc; border-radius: 20px; font-size: 12px; cursor: pointer; transition: all 0.2s; }
.section-chip:hover { background: #cce5ff; }
.section-chip.active { background: #0066cc; color: white; }
</style>

<div class="header">
    <div class="header-content">
        <div class="header-left">
            <div class="icon">â›·ï¸</div>
            <div class="header-text">
                <h1>Para AlpineSki - ì¢…í•© ë¶„ì„</h1>
                <p>GPS ì£¼í–‰ ë¶„ì„ + ì›€ì§ì„ ë¶„ì„</p>
            </div>
        </div>
        <div class="tab-navigation" id="tabNav" style="display: none;">
            <button class="tab-btn active" onclick="switchTab('gps')">ğŸ“ GPS ì£¼í–‰ ë¶„ì„</button>
            <button class="tab-btn" onclick="switchTab('motion')">ğŸƒ ì›€ì§ì„ ë¶„ì„</button>
        </div>
    </div>
</div>

<div id="uploadSection" class="upload-section">
    <div class="upload-card">
        <div class="upload-icon">ğŸ“‚</div>
        <h2>ì„¼ì„œ ë°ì´í„° í´ë”ë¥¼ ì„ íƒí•˜ì„¸ìš”</h2>
        <p>Location, Accelerometer, Gyroscope, Orientation, Metadata CSV íŒŒì¼ í¬í•¨</p>
        <input type="file" id="folderInput" webkitdirectory directory multiple style="display: none;">
        <button class="upload-btn" onclick="document.getElementById('folderInput').click()">ğŸ“ í´ë” ì„ íƒ</button>
        <div class="file-list" id="fileList"></div>
    </div>
</div>

<div id="gpsPage" class="page">
    <div class="container">
        <div class="left-panel">
            <div class="playback-controls">
                <div class="control-buttons">
                    <button class="control-btn" id="playBtn">â–¶ ì¬ìƒ</button>
                    <button class="control-btn" id="pauseBtn" disabled>â¸ ì¼ì‹œì •ì§€</button>
                    <button class="control-btn" id="resetBtn">â® ì²˜ìŒìœ¼ë¡œ</button>
                </div>
                <div class="progress-bar" id="progressBar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div class="time-display" id="timeDisplay">0:00 / 0:00</div>
            </div>
            
            <div class="card">
                <div id="map"></div>
            </div>
            
            <div class="card">
                <div class="card-header">ğŸŒ 3D GPS Path</div>
                <div class="card-content">
                    <div id="gps3dChart" style="height: 400px; padding: 10px;"></div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">ğŸš„ Skiing Speed</div>
                <div class="card-content">
                    <div id="speedChart" class="chart-container"></div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">â›°ï¸ Elevation Changes</div>
                <div class="card-content">
                    <div id="elevationChart" class="chart-container"></div>
                </div>
            </div>
        </div>
        
        <div class="right-panel">
            <div class="card">
                <div class="card-header">ğŸ“‹ ì¸¡ì • ì •ë³´</div>
                <div class="info-card">
                    <div class="info-label">ğŸ“± ë””ë°”ì´ìŠ¤</div>
                    <div class="info-value" id="deviceName">-</div>
                </div>
                <div class="info-card">
                    <div class="info-label">ğŸ“… ë‚ ì§œ</div>
                    <div class="info-value" id="measureDate">-</div>
                </div>
                <div class="info-card">
                    <div class="info-label">â° ì‹œê°„</div>
                    <div class="info-value" id="measureTime">-</div>
                </div>
                <div class="info-card">
                    <div class="info-label">ğŸ—ºï¸ ì¥ì†Œ</div>
                    <div class="info-value" id="location">-</div>
                </div>
                <div class="info-card">
                    <div class="info-label">ğŸŒ ìœ„ë„ / ê²½ë„</div>
                    <div class="info-value" id="coordinates">-</div>
                </div>
                <div class="info-card">
                    <div class="info-label">â›°ï¸ í‰ê·  ê³ ë„</div>
                    <div class="info-value" id="avgAltitude">-</div>
                </div>
            </div>
            
            <div class="card">
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value" id="workoutTime">-</div>
                        <div class="stat-unit">ìš´ë™ ì‹œê°„ (ë¶„)</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="elevationDiff">-</div>
                        <div class="stat-unit">ê³ ë„ ì°¨ì´ (m)</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="avgSpeed">-</div>
                        <div class="stat-unit">í‰ê·  ì†ë„ (m/s)</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="maxSpeed">-</div>
                        <div class="stat-unit">ìµœëŒ€ ì†ë„ (m/s)</div>
                    </div>
                </div>
            </div>
            
            <div class="event-markers">
                <h3>ğŸ“ êµ¬ê°„ ì„¤ì • (ì´ë²¤íŠ¸ ì‹œì )</h3>
                <button class="add-event-btn" id="addEventBtn">â• í˜„ì¬ ì‹œì  ê¸°ë¡</button>
                <div class="event-list" id="eventList">
                    <div style="text-align: center; color: #6c757d; padding: 20px; font-size: 12px;">
                        ê¸°ë¡ëœ ì‹œì ì´ ì—†ìŠµë‹ˆë‹¤
                    </div>
                </div>
                <div style="margin-top: 15px;">
                    <div style="font-size: 12px; color: #6c757d; margin-bottom: 8px;">ì‹œì ìœ¼ë¡œ ì£¼í–‰ êµ¬ê°„ ì €ì¥:</div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px;">
                        <select class="event-select" id="sectionStart">
                            <option value="">ì‹œì‘ ì‹œì </option>
                        </select>
                        <select class="event-select" id="sectionEnd">
                            <option value="">ì¢…ë£Œ ì‹œì </option>
                        </select>
                    </div>
                    <button class="analyze-btn" id="saveSectionBtn" style="background: #27ae60;">ğŸ’¾ ì£¼í–‰ êµ¬ê°„ ì €ì¥</button>
                </div>
            </div>
            
            <div id="sectionInfo" style="display: none;">
                <div class="section-info">
                    <h3>ğŸ“Š êµ¬ê°„ ë¯¸ë¦¬ë³´ê¸°</h3>
                    <div class="section-stats">
                        <div>
                            <div class="section-stat-label">êµ¬ê°„ ì‹œê°„</div>
                            <div class="section-stat-value" id="sectionTime">-</div>
                        </div>
                        <div>
                            <div class="section-stat-label">ê³ ë„ ë³€í™”</div>
                            <div class="section-stat-value" id="sectionElevation">-</div>
                        </div>
                        <div>
                            <div class="section-stat-label">í‰ê·  ì†ë„</div>
                            <div class="section-stat-value" id="sectionAvgSpeed">-</div>
                        </div>
                        <div>
                            <div class="section-stat-label">ìµœëŒ€ ì†ë„</div>
                            <div class="section-stat-value" id="sectionMaxSpeed">-</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="motionPage" class="page">
    <div class="container">
        <div class="left-panel">
            <div class="saved-sections">
                <h3>ğŸ“‚ ì €ì¥ëœ ì£¼í–‰ êµ¬ê°„</h3>
                <div class="section-list" id="sectionList">
                    <div style="color: #6c757d; font-size: 12px;">GPS í˜ì´ì§€ì—ì„œ êµ¬ê°„ì„ ì €ì¥í•˜ì„¸ìš”</div>
                </div>
            </div>
            
            <div class="playback-controls">
                <div class="control-buttons">
                    <button class="control-btn" id="playBtn2">â–¶ ì¬ìƒ</button>
                    <button class="control-btn" id="pauseBtn2" disabled>â¸ ì¼ì‹œì •ì§€</button>
                    <button class="control-btn" id="resetBtn2">â® ì²˜ìŒìœ¼ë¡œ</button>
                </div>
                <div class="progress-bar" id="progressBar2">
                    <div class="progress-fill" id="progressFill2"></div>
                </div>
                <div class="time-display" id="timeDisplay2">0:00 / 0:00</div>
            </div>
            
            <div class="card">
                <div id="map2"></div>
            </div>
            
            <div class="card">
                <div class="card-header">ğŸ“ˆ 3ì¶• ê°€ì†ë„</div>
                <div class="card-content">
                    <div id="accelChart" class="chart-container"></div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">ğŸ”„ 3ì¶• ìì´ë¡œìŠ¤ì½”í”„</div>
                <div class="card-content">
                    <div id="gyroChart" class="chart-container"></div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">ğŸ§­ Orientation (ë°©í–¥ ì„¼ì„œ)</div>
                <div class="card-content">
                    <div id="orientChart" class="chart-container"></div>
                </div>
            </div>
            <div class="card">
                <div class="card-header">ğŸ“Š ê°€ì†ë„ í•„í„°ë§ (Butterworth + Savitzky-Golay)</div>
                <div class="card-content">
                    <div id="accelFilterChart" class="chart-container"></div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">ğŸ“Š ê°ì†ë„ í•„í„°ë§ (Butterworth + Savitzky-Golay)</div>
                <div class="card-content">
                    <div id="gyroFilterChart" class="chart-container"></div>
                </div>
            </div>
        </div>
        
        <div class="right-panel">
            <div class="turn-detection">
                <h3>ğŸ¯ í„´ ì‹œì  ê²€ì¶œ</h3>
                <div class="detection-controls">
                    <div class="range-input">
                        <label>ê²€ì¶œ ì•Œê³ ë¦¬ì¦˜</label>
                        <select id="detectionAlgorithm">
                            <option value="quaternion_magnitude">Quaternion ë³€í™”ìœ¨</option>
                            <option value="quaternion_angle">Quaternion ê°ë„ ë³€í™”</option>
                            <option value="qy_peak">Quaternion Y í”¼í¬</option>
                            <option value="qz_peak">Quaternion Z í”¼í¬</option>
                            <option value="roll_pitch">Roll+Pitch í”¼í¬</option>
                            <option value="orientation">Orientation (ê¸°ì¡´)</option>
                        </select>
                    </div>
                    <div class="range-inputs">
                        <div class="range-input">
                            <label>í”¼í¬ ì„ê³„ê°’</label>
                            <input type="number" id="peakThreshold" value="0.05" step="0.01" min="0.01" max="1">
                        </div>
                        <div class="range-input">
                            <label>ìµœì†Œ í”¼í¬ ê°„ê²© (samples)</label>
                            <input type="number" id="minPeakDistance" value="50" min="10" max="200">
                        </div>
                    </div>
                    <button class="detect-btn" id="detectTurnsBtn">ğŸ” í„´ ìë™ ê²€ì¶œ</button>
                </div>
                <div class="turn-list" id="turnList">
                    <div style="text-align: center; color: #6c757d; padding: 40px; font-size: 13px;">
                        í„´ ê²€ì¶œ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”
                    </div>
                </div>
            </div>
            
            <div class="card">
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value" id="totalTurns">-</div>
                        <div class="stat-unit">ì´ í„´ íšŸìˆ˜</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="avgTurnSpeed">-</div>
                        <div class="stat-unit">í‰ê·  í„´ ì†ë„ (Â°/s)</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="maxAccel">-</div>
                        <div class="stat-unit">ìµœëŒ€ ê°€ì†ë„ (m/sÂ²)</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="avgGForce">-</div>
                        <div class="stat-unit">í‰ê·  G-Force</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="dashboard_part2.js"></script>
</body>
</html>
